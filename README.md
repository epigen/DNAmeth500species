# DNAmeth500species
Comparative analysis of DNA methylation across more than 500 animal species

1. The init file src/00.0_init.R is user specific and needs to be slightly adapted (one path section)

2. The src/00.0_init.R script to initialize all further scripts, it will standardize setting, make annotations availble, and set paths to data and scripts. First numbers after . indicates the order, in which scripts should be run. 
In general, scripts can be divided into two categories - ones, that have to be ran in HPC mode on each species in parallel, and summary/vizualization scripts, that generate summary tables and figures. In first case the corresponding sbatch script with reccomended parametrs to run the job is provided. (those need to be updated, depending on the comutational setup)

## Reproducing the project step-by-step
### 00: pre-analysis

Preparing to run RefFreeDMA, if you want to repeat the steps from the raw data
```bash
Rscript 00.1_prepareRefFreeDMA.R 
```

the quality control, based on the unconverted samples (for several steps):
```bash
sbatch sbatch/00.21.sbatch
#vizualize
Rscript 00.22__plot_QC.R
```
Generation of the phylogenetic tree for iTOl, it's optimization for future analysis and exporting the phylogenetic order of species for future use:

```bash
Rscript 00.3_create_ITOL.R
Rscript 00.31_species_order.R
```

### 01: Main statisctics

Creating the big summary annotation table and other initial stats:
```bash
Rscript 01.1_collectStats.R
RScript 01.2_taxonomicAnnotation.R. #generates the stats annot table
RScript 01.3_quality_stratification.R
```
Further scripts in the 01 section generate the statistical vizualizations, corresponding to the analysis in the paper and can be used as a starting point for personalized analysis.
Improtantly, for some part of 01.6 ananlysis data is generated by the 01.61 script

```bash
RScript 01.61_dedRef_CpG_count.R
```
### 02: Prediction of DNA methylation from sequence

First the prediction scripts have to be run in a parallelized mode:
```bash
sbatch 02.1.sbatch ##prediction of DNA methylation within species: repeated on k 1:10, k = 3, k = 4, k = 7
sbatch 02.2.sbatch ##prediction of DNA methylation across species
```
Results of this experiments are summarised, analysed and interpreted using scripts 02.5.1, 02.5.2 and 02.6
Supplementory analysis:
```bash
sbatch 02.1.sbatch ##prediction of DNA methylation across species and tissues
sbatch 02.1.1.sbatch ##prediction of DNA methylation within species
```
